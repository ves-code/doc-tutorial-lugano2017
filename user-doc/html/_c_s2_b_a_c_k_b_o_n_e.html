<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>PLUMED: CS2BACKBONE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_c_s2_b_a_c_k_b_o_n_e.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CS2BACKBONE </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the colvar <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>This collective variable calculates the backbone chemical shifts for a protein.</p>
<p>The functional form is that of CamShift <a class="el" href="citelist.html#CITEREF_Kohlhoff:2009us">[42]</a>. The chemical shifts of the selected nuclei/residues are saved as components. Reference experimental values can also be stored as components. The two components can then be used to calculate either a scoring function as in <a class="el" href="citelist.html#CITEREF_Robustelli:2010dn">[57]</a> <a class="el" href="citelist.html#CITEREF_Granata:2013dk">[36]</a>, using the keyword CAMSHIFT or to calculate ensemble averages chemical shift per chemical shift as in <a class="el" href="citelist.html#CITEREF_Camilloni:2012je">[23]</a> <a class="el" href="citelist.html#CITEREF_Camilloni:2013hs">[25]</a> (see <a class="el" href="_s_t_a_t_s.html">STATS</a> and <a class="el" href="_e_n_s_e_m_b_l_e.html">ENSEMBLE</a>).</p>
<p>CamShift calculation is relatively heavy because it often uses a large number of atoms, in order to make it faster it is currently parallelised with <a class="el" href="_openmp.html">OpenMP</a>.</p>
<p>As a general rule, when using <a class="el" href="_c_s2_b_a_c_k_b_o_n_e.html">CS2BACKBONE</a> or other experimental restraints it is better to increase the accuracy of the constraint algorithm due to the increased strain on the bonded structure. In the case of GROMACS it is safer to use lincs-iter=2 and lincs-order=6.</p>
<p>In general the system for which chemical shifts are calculated must be completly included in ATOMS and a TEMPLATE pdb file for the same atoms should be provided as well in the folder DATA. The atoms are made automatically whole unless NOPBC is used, in particular if the system is made of by multiple chains it is usually better to use NOPBC and make the molecule whole <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> selecting an appropriate order.</p>
<p>In addition to a pdb file one needs to provide a list of chemical shifts to be calculated using one file per nucleus type (CAshifts.dat, CBshifts.dat, Cshifts.dat, Hshifts.dat, HAshifts.dat, Nshifts.dat), all the six files should always be present. A chemical shift for a nucleus is calculated if a value greater than 0 is provided. For practical purposes the value can correspond to the experimental value. Residues numbers should go from 1 to N irrespectively of the numbers used in the pdb file. The first and last residue of each chain should be preceeded by a # character. Termini groups like ACE or NME should be removed from the PDB.</p>
<pre class="fragment">CAshifts.dat:
#1 0.0
2 55.5
3 58.4
.
.
#last 0.0
#last+1 (first) of second chain
.
#last of second chain
</pre><p>The default behaviour is to store the values for the active nuclei in components (ca_#, cb_#, co_#, ha_#, hn_#, nh_# and expca_#, expcb_#, expco_#, expha_#, exphn_#, exp_nh#) with NOEXP it is possible to only store the backcalculated values.</p>
<p>A pdb file is needed to the generate a simple topology of the protein. For histidines in protonation states different from D the HIE/HSE HIP/HSP name should be used. GLH and ASH can be used for the alternative protonation of GLU and ASP. Non-standard amino acids and other molecules are not yet supported, but in principle they can be named UNK. If multiple chains are present the chain identifier must be in the standard PDB format, together with the TER keyword at the end of each chain.</p>
<p>One more standard file is also needed in the folder DATA: camshift.db. This file includes all the CamShift parameters and can be found in regtest/basic/rt45/data/ .</p>
<p>All the above files must be in a single folder that must be specified with the keyword DATA.</p>
<p>Additional material and examples can be also found in the tutorial <a class="el" href="belfast-9.html">Belfast tutorial: NMR restraints</a></p>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>The names of the components in this action can be customized by the user in the actions input file. However, in addition to these customizable components the following quantities will always be output</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> ha </b> </td><td>the calculated Ha hydrogen chemical shifts   </td></tr>
<tr>
<td width="15%"><b> hn </b> </td><td>the calculated H hydrogen chemical shifts   </td></tr>
<tr>
<td width="15%"><b> nh </b> </td><td>the calculated N nitrogen chemical shifts   </td></tr>
<tr>
<td width="15%"><b> ca </b> </td><td>the calculated Ca carbon chemical shifts   </td></tr>
<tr>
<td width="15%"><b> cb </b> </td><td>the calculated Cb carbon chemical shifts   </td></tr>
<tr>
<td width="15%"><b> co </b> </td><td>the calculated C' carbon chemical shifts   </td></tr>
<tr>
<td width="15%"><b> expha </b> </td><td>the experimental Ha hydrogen chemical shifts   </td></tr>
<tr>
<td width="15%"><b> exphn </b> </td><td>the experimental H hydrogen chemical shifts   </td></tr>
<tr>
<td width="15%"><b> expnh </b> </td><td>the experimental N nitrogen chemical shifts   </td></tr>
<tr>
<td width="15%"><b> expca </b> </td><td>the experimental Ca carbon chemical shifts   </td></tr>
<tr>
<td width="15%"><b> expcb </b> </td><td>the experimental Cb carbon chemical shifts   </td></tr>
<tr>
<td width="15%"><b> expco </b> </td><td>the experimental C' carbon chemical shifts   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ATOMS </b> </td><td>The atoms to be included in the calculation, e.g. the whole protein.. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> DATA </b> </td><td>( default=data/ ) The folder with the experimental chemical shifts.   </td></tr>
<tr>
<td width="15%"><b> TEMPLATE </b> </td><td>( default=template.pdb ) A PDB file of the protein system to initialise ALMOST.   </td></tr>
<tr>
<td width="15%"><b> NEIGH_FREQ </b> </td><td>( default=20 ) Period in step for neighbour list update.   </td></tr>
<tr>
<td width="15%"><b> NRES </b> </td><td>Number of residues, corresponding to the number of chemical shifts.   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> CAMSHIFT </b> </td><td>( default=off ) Set to TRUE if you to calculate a single CamShift score.   </td></tr>
<tr>
<td width="15%"><b> NOEXP </b> </td><td><p class="starttd">( default=off ) Set to TRUE if you don't want to have fixed components with the experimetnal values.  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In this first example the chemical shifts are used to calculate a scoring function to be used in NMR driven Metadynamics <a class="el" href="citelist.html#CITEREF_Granata:2013dk">[36]</a> :</p>
<pre class="fragment">whole: GROUP ATOMS=2612-2514:-1,961-1:-1,2466-962:-1,2513-2467:-1
WHOLEMOLECULES ENTITY0=whole
cs: CS2BACKBONE ATOMS=1-2612 NRES=176 DATA=../data/ TEMPLATE=template.pdb CAMSHIFT NOPBC 
metad: METAD ARG=cs HEIGHT=0.5 SIGMA=0.1 PACE=200 BIASFACTOR=10
PRINT ARG=cs,metad.bias FILE=COLVAR STRIDE=100 
</pre><p>In this second example the chemical shifts are used as replica-averaged restrained as in <a class="el" href="citelist.html#CITEREF_Camilloni:2012je">[23]</a> <a class="el" href="citelist.html#CITEREF_Camilloni:2013hs">[25]</a>.</p>
<pre class="fragment">cs: CS2BACKBONE ATOMS=1-174 DATA=data/ NRES=13 
encs: ENSEMBLE ARG=(cs\.hn_.*),(cs\.nh_.*)
stcs: STATS ARG=encs.* SQDEVSUM PARARG=(cs\.exphn_.*),(cs\.expnh_.*)
RESTRAINT ARG=stcs.sqdevsum AT=0 KAPPA=0 SLOPE=24

PRINT ARG=(cs\.hn_.*),(cs\.nh_.*) FILE=RESTRAINT STRIDE=100</pre><p>(See also <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a>, <a class="el" href="_s_t_a_t_s.html">STATS</a>, <a class="el" href="_m_e_t_a_d.html">METAD</a>, <a class="el" href="_r_e_s_t_r_a_i_n_t.html">RESTRAINT</a> and <a class="el" href="_p_r_i_n_t.html">PRINT</a>) </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective variables</a></li><li class="navelem"><a class="el" href="_colvar.html">CV Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
