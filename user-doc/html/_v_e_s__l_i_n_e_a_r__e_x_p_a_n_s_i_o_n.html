<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>PLUMED: VES_LINEAR_EXPANSION</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_v_e_s__l_i_n_e_a_r__e_x_p_a_n_s_i_o_n.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">VES_LINEAR_EXPANSION </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Linear basis set expansion bias.</p>
<p>This bias action takes the bias potential to be a linear expansion in some basis set that is written as a product of one-dimensional basis functions. For example, for one CV the bias would be written as </p><p class="formulaDsp">
\[ V(s_{1};\boldsymbol{\alpha}) = \sum_{i_{1}} \alpha_{i_{1}} \, f_{i_{1}}(s_{1}), \]
</p>
<p> while for two CVs it is written as </p><p class="formulaDsp">
\[ V(s_{1},s_{2};\boldsymbol{\alpha}) = \sum_{i_{1},i_{2}} \alpha_{i_{1},i_{2}} \, f_{i_{1}}(s_{1}) \, f_{i_{2}}(s_{2}) \]
</p>
<p> where \(\boldsymbol{\alpha}\) is the set of expansion coefficients that are optimized within VES. With an appropriate choice of the basis functions it is possible to represent any generic free energy surface. The relationship between the bias and the free energy surface is given by </p><p class="formulaDsp">
\[ V(\mathbf{s}) = - F(\mathbf{s}) - \frac{1}{\beta} \log p(\mathbf{s}). \]
</p>
<p> where \(p(\mathbf{s})\) is the target distribution that is employed in the VES simulation.</p>
<dl class="section user"><dt>Basis Functions</dt><dd></dd></dl>
<p>Various one-dimensional basis functions are available in the VES code, see the complete list <a class="el" href="ves_basisf.html">here</a>. At the current moment we recommend to use <a class="el" href="_b_f__l_e_g_e_n_d_r_e.html">legendre polynomicals</a> for non-periodic CVs and <a class="el" href="_b_f__f_o_u_r_i_e_r.html">Fourier basis functions</a> for periodic CV (e.g. dihedral angles).</p>
<p>To use these basis functions within VES_LINEAR_EXPANSION do you first need to define them in the input file before the VES_LINEAR_EXPANSION action and then give their labels using the BASIS_FUNCTIONS keyword.</p>
<dl class="section user"><dt>Target Distributions</dt><dd></dd></dl>
<p>The default option is to employ a uniform target distribution. Various other target distributions \(p(\mathbf{s})\) are available in the VES code, see the complete list <a class="el" href="ves_targetdist.html">here</a>. To use any of these target distribution you need to use the TARGET_DISTRIBUTION keyword where the keyword relevant to the target distribution are enclosed within curly brackets.</p>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quanties can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> force2 </b> </td><td>the instantaneous value of the squared force due to this bias potential.   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> BASIS_FUNCTIONS </b> </td><td>the label of the basis sets that you want to use   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td><p class="starttd">( default=off ) calculate the derivatives for these quantities numerically  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature - this is needed if the MD code does not pass the temperature to PLUMED.   </td></tr>
<tr>
<td width="15%"><b> BIAS_FILE </b> </td><td>filename of the file on which the bias should be written out. By default it is bias.LABEL.data. Note that suffixes indicating the iteration number (iter-#) are added to the filename when optimizing coefficients.   </td></tr>
<tr>
<td width="15%"><b> FES_FILE </b> </td><td>filename of the file on which the FES should be written out. By default it is fes.LABEL.data. Note that suffixes indicating the iteration number (iter-#) are added to the filename when optimizing coefficients.   </td></tr>
<tr>
<td width="15%"><b> TARGETDIST_FILE </b> </td><td>filename of the file on which the target distribution should be written out. By default it is targetdist.LABEL.data. Note that suffixes indicating the iteration number (iter-#) are added to the filename when optimizing coefficients.   </td></tr>
<tr>
<td width="15%"><b> COEFFS </b> </td><td>read-in the coefficents from files.   </td></tr>
<tr>
<td width="15%"><b> TARGET_DISTRIBUTION </b> </td><td>the target distribution to be used. See the list in <a class="el" href="ves_targetdist.html">Target Distributions</a>   </td></tr>
<tr>
<td width="15%"><b> BIAS_CUTOFF </b> </td><td>cutoff the bias such that it only fills the free energy surface up to certain level F_cutoff, here you should give the value of the F_cutoff.   </td></tr>
<tr>
<td width="15%"><b> BIAS_CUTOFF_FERMI_LAMBDA </b> </td><td>the lambda value used in the Fermi switching function for the bias cutoff (BIAS_CUTOFF). Lambda is by default 1.0.   </td></tr>
<tr>
<td width="15%"><b> GRID_BINS </b> </td><td>the number of bins used for the grid. The default value is 100 bins per dimension.   </td></tr>
<tr>
<td width="15%"><b> PROJ_ARG </b> </td><td>arguments for doing projections of the FES or the target distribution. You can use multiple instances of this keyword i.e. PROJ_ARG1, PROJ_ARG2, PROJ_ARG3...   </td></tr>
<tr>
<td width="15%"><b> ARG </b> </td><td><p class="starttd">the input for this action is the scalar output from one or more other actions. The particular scalars that you will use are referenced using the label of the action. If the label appears on its own then it is assumed that the Action calculates a single scalar value. The value of this scalar is thus used as the input to this new action. If * or *.* appears the scalars calculated by all the proceding actions in the input file are taken. Some actions have multi-component outputs and each component of the output has a specific label. For example a <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> action labelled dist may have three componets x, y and z. To take just the x component you should use dist.x, if you wish to take all three components then use dist.*.More information on the referencing of Actions can be found in the section of the manual on the PLUMED <a class="el" href="_syntax.html">Getting started</a>. Scalar values can also be referenced using POSIX regular expressions as detailed in the section on <a class="el" href="_regex.html">Regular Expressions</a>. To use this feature you you must compile PLUMED with the appropriate flag. You can use multiple instances of this keyword i.e. ARG1, ARG2, ARG3...  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="ves_main.html">Variationally Enhanced Sampling</a></li><li class="navelem"><a class="el" href="ves_biases.html">Bias</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
